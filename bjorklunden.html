<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <script type="text/javascript">

    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        html {
            height: 100%;
        }

        body {
            text-align: center;
            background-color: rgb(35, 35, 35);
            height: 100%;
        }

        img.picture {
            display: block;
            border: 1px solid gray;
            max-width: 100%;
            max-height: calc(100vh - 35px);
        }

        .slidecontainer {
            width: 100%;
        }

        .slider {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 15px;
            background: #d3d3d3;
            outline: none;
            opacity: 0.7;
            -webkit-transition: .2s;
            transition: opacity .2s;
            margin: 0;
            margin-top: 2px;
        }

        .slider:hover {
            opacity: 1;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none; /* Override default look */
            appearance: none;
            width: 25px;
            height: 15px;
            background: #80ABB7;
            cursor: pointer;
        }

        .slider::-moz-range-thumb {
            width: 25px;
            height: 15px;
            background: #80ABB7;
            cursor: pointer;
        }

        .content {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-around;
            min-height: min(100%, 1000px);
        }

        #box {
            position: relative;
        }

        #progress {
            position: absolute;
            right: 0;
            color: white;
            opacity: .3;
        }

        #gallery {
            position: relative;
            border: 10px solid white;
            cursor: pointer; /* Cursor on hover */
            min-width: 1090px;
            min-height: 709px;
        }

        #gallery > img.picture:nth-child(n+2) {
            position: absolute;
            top: 0;
            left: 0;
        }

        #gallery > img.fading {
            -webkit-transition: opacity 0.3s ease-in;
            -moz-transition: opacity 0.3s ease-in;
            -o-transition: opacity 0.3s ease-in;
            transition: opacity 0.3s ease-in;
        }

        #playbutton {
            position: absolute;
            filter: drop-shadow(10px 10px 5px rgba(0, 0, 0, .7));
            left: calc(50% - 110px);
            top: calc(50% - 150px);
            z-index: 1;
            pointer-events: none;
        }

        .hidden {
            opacity: 0;
            scale: 200%;
            -webkit-transition: all 0.5s ease-out;
            -moz-transition: all 0.5s ease-out;
            -o-transition: all 0.5s ease-out;
            transition: all 0.5s ease-out;
        }

        input {
            display: inline-block;
        }

    </style>
</head>
<body>
<div class=content>
    <div id="box">
        <svg id="playbutton" height="300" width="300" style="background-color:transparent">
            <polygon
                    points="20,20 240,150 20,280"
                    style="stroke: lightgray; fill: transparent; stroke-width: 40; stroke-linejoin: round;"/>
        </svg>
        <div id=gallery>
            <img src="seasons-4868-1.jpg" class="picture">
        </div>
        <div class="slidecontainer">
            <input type="range" min="1" max="52" value="0" class="slider" id="slider">
        </div>
        <span id="progress"></span>
    </div>
</div>
</body>
<script type="text/javascript">
    // todo: simplify this, just add one image and remove the oldest one instead of having a full stack of them
    // todo: preload before running?
    // todo: add some cue that we can click the image for animation
    // todo: maybe swipe on image?
    // todo: add date information, somehow
    let slider = document.getElementById("slider");
    let output = document.getElementById("gallery");
    let progress = document.getElementById("progress");
    let playbutton = document.getElementById("playbutton");

    let imageNames = [
        "seasons-4868-1.jpg",
        "seasons-4868-2.jpg",
        "seasons-4868-3.jpg",
        "seasons-4868-4.jpg",
        "seasons-4868-5.jpg",
        "seasons-4868-6.jpg",
        "seasons-4868-7.jpg",
        "seasons-4868-8.jpg",
        "seasons-4868-9.jpg",
        "seasons-4868-10.jpg",
        "seasons-4868-11.jpg",
        "seasons-4868-12.jpg",
        "seasons-4868-13.jpg",
        "seasons-4868-14.jpg",
        "seasons-4868-15.jpg",
        "seasons-4868-16.jpg",
        "seasons-4868-17.jpg",
        "seasons-4868-18.jpg",
        "seasons-4868-19.jpg",
        "seasons-4868-20.jpg",
        "seasons-4868-21.jpg",
        "seasons-4868-22.jpg",
        "seasons-4868-23.jpg",
        "seasons-4868-24.jpg",
        "seasons-4868-25.jpg",
        "seasons-4868-26.jpg",
        "seasons-4868-27.jpg",
        "seasons-4868-28.jpg",
        "seasons-4868-29.jpg",
        "seasons-4868-30.jpg",
        "seasons-4868-31.jpg",
        "seasons-4868-32.jpg",
        "seasons-4868-33.jpg",
        "seasons-4868-34.jpg",
        "seasons-4868-35.jpg",
        "seasons-4868-36.jpg",
        "seasons-4868-37.jpg",
        "seasons-4868-38.jpg",
        "seasons-4868-39.jpg",
        "seasons-4868-40.jpg",
        "seasons-4868-41.jpg",
        "seasons-4868-42.jpg",
        "seasons-4868-43.jpg",
        "seasons-4868-44.jpg",
        "seasons-4868-45.jpg",
        "seasons-4868-46.jpg",
        "seasons-4868-47.jpg",
        "seasons-4868-48.jpg",
        "seasons-4868-49.jpg",
        "seasons-4868-50.jpg",
        "seasons-4868-51.jpg",
        "seasons-4868-52.jpg",
    ];

    let animation = false;
    let interval = 0;

    // When dragging the slider
    slider.oninput = function () {
        playbutton.classList.add('hidden');
        clearInterval(interval);
        let image = images[this.value - 1];
        output.innerHTML = '';
        output.appendChild(image);
        animation = false;
    };

    function toggleAnimation() {
        playbutton.classList.add('hidden');
        clearInterval(interval);

        function pushImage(next) {
            let image = images[next - 1];
            image.classList.remove('fading');
            image.style.opacity = 0;
            output.appendChild(image)
            if (output.children.length > 2) {
                output.removeChild(output.firstChild);
            }
            // https://gist.github.com/paulirish/5d52fb081b3570c81e3a
            image.getBoundingClientRect()
            image.classList.add('fading');
            image.style.opacity = 1;
        }

        function getNext() {
            let current = parseInt(slider.value);
            let next = current + 1;
            if (next > parseInt(slider.max)) {
                next = 1;
            }
            return next;
        }

        if (!animation) {
            animation = true;
            let next = getNext();
            pushImage(next);

            slider.value = next;
            interval = setInterval(() => {
                let next = getNext();
                pushImage(next);
                slider.value = next;
            }, 1000 / 2);
        } else {
            animation = false;
        }
    }

    let loaded = 0;
    let images = imageNames.map(name => {
        let image = new Image();
        image.src = name;
        if (image.complete) {
            loaded++;
        } else {
            progress.innerHTML = `Loading: 0 / ${imageNames.length}...`;

            image.onload = function () {
                loaded++;
                if (loaded === images.length) {
                    progress.innerHTML = '';
                } else {
                    progress.innerHTML = `Loading: ${loaded} / ${images.length}...`;
                }
            };
        }
        image.classList.add('picture');
        return image;
    });

    output.addEventListener('click', toggleAnimation);
</script>
</html>
